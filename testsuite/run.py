import os
import sys
from subprocess import Popen, PIPE

TESTS = [
    '4',
    '3 + 6',
    '2 * 8',
    '2 - 8',
    '12 / 2',
    '10 / 3',
    '5 % 1',
    '7 % 2',
    '1+2+3+4+5',
    '12*3+5/6+2',
    '999*999*999*999*999*999',
    '12345678987654321',
    '12345678987654321 + 2',
    '12345678987654321 - 2',
    '12345678987654321 * 11',
    '12345678987654321 / 17',
    '12345678987654321 % 17',
    '5400000000 * 1285647343',
    '12345678987654321 + 12398765435',
    '12345678987654321 - 12398765435',
    '123456789876 - 12345678987654321',
    '12345678987654321 / 12398765435',
    '12345678987654321 % 12398765435',
    '(4+3)*(2+1)-18*(4/3)+(4*(1+2)/(2-1))+(((2)))',
    '((12+4)*2)/((3 - 1) + 1) * (1+(3*2) - (5%(1+2*(1+3))*3) + 6)'
]


nsucc = 0

for t in TESTS:
    ref = int(eval(t))

    p = Popen(['./calc', t], stdout=PIPE)
    val = int(p.stdout.read())

    if ref == val:
        print('Test {}: [OK]'.format(t))
        nsucc += 1
    else:
        print('Test {} [KO!!!]'.format(t))
        print('--  me: {}'.format(val))
        print('-- ref: {}'.format(ref))
    

print('Test suite results: {} / {}'.format(nsucc, len(TESTS)))
